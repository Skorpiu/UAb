<html>
	<head>
		<title>Recorte de geometrias</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
			.button {
				background-color: #4CAF50;
				border: none;
				color: white;
				padding: 15px 25px;
				text-align: center;
				font-size: 16px;
			cursor: pointer;
			}

			.button:hover {
			  background-color: green;
			}
		</style>
	</head>
	<body>
		<button class="button" onclick="clipPlanes()">Alterna recorte...</button>
		<script src="js/three.js"></script>
		<script>
			var scene, camera, renderer;
			var geometry, material, onoff, dodecaedro;
			var dodecaedroEdges, plane;
			var localPlane, globalPlane;
			
			init();
			animate();
			
			function init() {
				scene = new THREE.Scene();
				camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 );
				renderer = new THREE.WebGLRenderer();
				renderer.setSize( window.innerWidth, window.innerHeight );
				document.body.appendChild( renderer.domElement );
				camera.position.z = 8;
				
				localPlane = new THREE.Plane( new THREE.Vector3( 0, 1, 0 ), 1 ); // planos de recorte do objeto
				globalPlane = new THREE.Plane( new THREE.Vector3( 1, 0, 0 ), 1 );
				
				
				/*material = new THREE.MeshPhongMaterial( {
						clippingPlanes: [ localPlane ],
						clipShadows: true
					} );*/
				drawThings();
				onoff = false;
			}
			
			function drawThings() {
			// Desenho do dodecaedro e arestas
				geometry = new THREE.DodecahedronGeometry( 2.0, 0 );
				material = new THREE.MeshBasicMaterial( { color: 0xdd42fc } );
				dodecaedro = new THREE.Mesh( geometry, material );
			
				var edges = new THREE.EdgesGeometry( geometry );
				dodecaedroEdges = new THREE.LineSegments( edges, new THREE.LineBasicMaterial( { color: 0xffffff } ) );
			
				scene.add( dodecaedro );
				scene.add( dodecaedroEdges );
			
			// Desenho de um plano
				geometry = new THREE.PlaneGeometry( 8, 8, 32);
				material = new THREE.MeshBasicMaterial( {color: 0xffff00, side: THREE.DoubleSide} );
				plane = new THREE.Mesh( geometry, material );
				plane.position.x = 0;
				plane.position.y = 0;
				plane.position.z = -3;
				scene.add( plane );
			
			// Desenho de um torus em n√≥			
				geometry = new THREE.TorusKnotGeometry( 10, 3, 100, 16  );
				material = new THREE.MeshBasicMaterial( { color: 0xff0000 } );
				torusKnot = new THREE.Mesh( geometry, material );
				torusKnot.position.z = -30;
				torusKnot.position.x = -20;
				scene.add( torusKnot );
				
				edges = new THREE.EdgesGeometry( geometry );
				torusKnotEdges = new THREE.LineSegments( edges, new THREE.LineBasicMaterial( { color: 0xffffff } ) );
				torusKnotEdges.position.z = -30;
				torusKnotEdges.position.x = -20;
				scene.add( torusKnotEdges );
			}
			
		// Ativa diferentes planos de recorte na cena			
			function clipPlanes() {
				onoff = !onoff;
				if (onoff) {
					renderer.clippingPlanes = [ localPlane ];
					renderer.localClippingEnabled = true;
				} else {
					renderer.clippingPlanes = [ globalPlane ];
					renderer.localClippingEnabled = true;
				}
			}
			
		// Adiciona efeito animado a cena
			function animate () {
				requestAnimationFrame( animate );

				dodecaedro.rotation.x += 0.01;
				dodecaedro.rotation.y += 0.01;
				dodecaedroEdges.rotation.x += 0.01;
				dodecaedroEdges.rotation.y += 0.01;
				plane.rotation.x += 0.01;
				plane.rotation.y += 0.01;

				renderer.render( scene, camera );
			};
		</script>
	</body>
</html>